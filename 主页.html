<style type="text/css">
div p {
    text-align: center;
    /* “粉-蓝-紫”梦幻渐变 - 核心视觉风格 */
    background: -webkit-linear-gradient(left, #ff9a9e 0%, #fecfef 20%, #a1c4fd 40%, #c2e9fb 60%, #fecfef 80%, #ff9a9e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    -webkit-background-size: 200% 100%;
    /* 动画：让渐变色流动起来 */
    -webkit-animation: runs 5s infinite linear;
    
    /* 强力光晕效果，增强夜间模式的质感 */
    filter: drop-shadow(0 0 8px rgba(254, 207, 239, 0.6));
    font-weight: bold; 
}
@-webkit-keyframes runs {
    0% { background-position: 0 0; }
    100% { background-position: 100% 0; }
}
</style>

<div id="miracle_box" style="position: absolute; top: -32vw; width: 100%; text-align: center; font-size: 32px; transition: opacity 0.5s ease, transform 0.5s ease; z-index: 0; pointer-events: none;">
    <p>你的存在便是奇迹</p>
</div>

<script>
(function() {
    // 配置：搜索引擎列表
    const engines = {
        i: { name: "默认", url: "" }, 
        bd: { name: "百度", url: "https://m.baidu.com/s?word=" },
        gg: { name: "谷歌", url: "https://www.google.com/search?query=" },
        bing: { name: "必应", url: "https://cn.bing.com/search?q=" },
        dk: { name: "Duck", url: "https://duckduckgo.com/?q=" },
        gk: { name: "夸克", url: "https://quark.sm.cn/s?q=" },
        sg: { name: "搜狗", url: "https://m.sogou.com/web/searchList.jsp?keyword=" },
        zh: { name: "知乎", url: "https://www.zhihu.com/search?q=" },
        c: { name: "其他", url: localStorage.getItem("c") || "" },
        m: { name: "重设", disabled: (!localStorage.getItem("c") || localStorage.getItem("se") !== "c") }
    };

    window.addEventListener("DOMContentLoaded", function() {
        const s_input = document.getElementById("search_input");
        const m_box = document.getElementById("miracle_box");
        const content = document.getElementById("content");
        const s_submit = document.getElementById("search_submit");

        // 1. 移动标语位置
        if (content && m_box && m_box.parentNode !== content) {
            content.appendChild(m_box);
        }

        // 2. 搜索框动画交互
        if (s_input && m_box) {
            s_input.addEventListener("focus", () => {
                m_box.style.opacity = "0";
                m_box.style.transform = "translateY(-20px)";
            });
            s_input.addEventListener("blur", () => {
                m_box.style.opacity = "1";
                m_box.style.transform = "translateY(0)";
            });
            s_input.setAttribute('placeholder', '星河浩瀚,万人争渡');
        }

        // 3. 搜索引擎切换与核心搜索逻辑
        if (s_submit) {
            const select = document.createElement("select");
            
            // 下拉框样式
            Object.assign(select.style, {
                color: "#FFFFFF",
                float: "left",
                height: "46px",
                border: "none",
                paddingLeft: "10px",
                background: "transparent",
                outline: "none",
                borderRadius: "inherit"
            });

            // 生成选项
            let optionsHTML = "";
            for (let key in engines) {
                const item = engines[key];
                const disabledStr = item.disabled ? "disabled" : "";
                optionsHTML += `<option value="${key}" ${disabledStr}>${item.name}</option>`;
            }
            select.innerHTML = optionsHTML;
            select.value = localStorage.getItem("se") || "i";

            // 切换引擎事件
            select.onchange = function() {
                const val = this.value;
                if (val !== "c" && val !== "m") {
                    localStorage.setItem("se", val);
                    this.lastElementChild.disabled = true;
                } else {
                    let customUrl = prompt("请修改自定义地址\n注：via上取消也可能会清空(′⊙ω⊙`)", localStorage.getItem("c") || "");
                    customUrl = (customUrl || "").trim();
                    if (customUrl) {
                        localStorage.setItem("c", customUrl);
                        localStorage.setItem("se", "c");
                        this.value = "c";
                    } else {
                        this.value = "i";
                    }
                }
            };
            s_submit.parentElement.insertBefore(select, s_submit);
            window.search = function() {
                // 获取当前输入的值
                var val = s_input.value.trim();
                
                if (val) {
                    if (/^https?:\/\//i.test(val)) {
                        window.location.href = val;
                        return false;
                    }

                    // 获取当前引擎的前缀
                    var engine = engines[select.value];
                    var prefix = engine.url;
                    if (prefix === "") {
                        prefix = "https://m.baidu.com/s?word="; 
                    }
                    window.location.href = prefix + val;
                }
                return false;
            };
        }
    });
})();
</script>

<script src="https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0"></script>
<script>
    fetch('https://v1.jinrishici.com/all.txt')
        .then(response => response.text())
        .then(text => {
            const titleElement = document.getElementsByTagName("title")[0];
            if(titleElement) titleElement.innerText = text;
        })
        .catch(err => console.log("诗词获取失败", err));
</script>
<script src="https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0"></script>
<script>
    // 异步获取古诗词
    fetch('https://v1.jinrishici.com/all.txt')
        .then(response => response.text())
        .then(text => {
            const titleElement = document.getElementsByTagName("title")[0];
            if(titleElement) titleElement.innerText = text;
        })
        .catch(err => console.log("诗词获取失败", err));

    // 标题处理逻辑
    /* try {
        if (typeof str !== 'undefined') {
            var s = false;
            var t = document.getElementsByTagName("title")[0];
            t.innerHTML = s ? (str[0] + str[1]) : str[0];
        }
    } catch(e) {}
    */
</script>